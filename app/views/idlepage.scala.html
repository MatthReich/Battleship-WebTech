@import play.api.i18n.Messages
@import play.api.mvc.RequestHeader
@import org.webjars.play.WebJarsUtil
@import controllers.AssetsFinder
@import play.api.data._
@import forms.TotpSetupForm.Data
@import com.mohiva.play.silhouette.impl.providers.GoogleTotpCredentials
@import com.mohiva.play.silhouette.impl.providers.GoogleTotpInfo
@import Battleship.controller.ControllerBaseImpl.PlayerState

@this()(implicit webJarsUtil: WebJarsUtil, assets: AssetsFinder)
@(user: models.User, totpInfoOpt: Option[GoogleTotpInfo], controller: Battleship.controller.InterfaceController, totpDataOpt: Option[(Form[Data], GoogleTotpCredentials)] = None)(implicit request: RequestHeader, messages: Messages)
@implicitFieldConstructor = @{
    b4.vertical.fieldConstructor()
}
@main(messages("home.title"), Some(user)) {
    <div class="user col-md-6 col-md-offset-3">
            <script src="@assets.path("javascripts/gamehandler.js")" type="text/javascript"></script>
            <body id="body_gamepage">
                <div class="gamecontainer">
                    <div class="game row">
                        <div class="player1 col-md-6">
                            <div class="playerName">
                            @{
                                controller.getPlayer1.toString
                            }
                            </div>
                            <div class="clear"></div>
                            @for(row <- 0 until 10) {
                                <div class="grid-container">
                                @for(col <- 0 until 10) {
                                    <span class="grid-item">
                                        <button name="submit" type="button" class="btn btn-outline-secondary buttonSize" id="1@row@col" onclick="handleClick(@row, @col)">
                                        @{
                                            if(controller.getPlayerState == PlayerState.PLAYER_ONE) {
                                                if(controller.getGridPlayer1.getValue(row, col) == 0) {
                                                        <span class="blue">~</span>
                                                }
                                                else if(controller.getGridPlayer1.getValue(row, col) == 1) {
                                                        <span class="green">x</span>
                                                } else if(controller.getGridPlayer1.getValue(row, col) == 2) {
                                                        <span class="red">x</span>
                                                } else if(controller.getGridPlayer1.getValue(row, col) == 3) {
                                                        <span class="lightblue">0</span>
                                                }
                                            } else if(controller.getPlayerState == PlayerState.PLAYER_TWO) {
                                                if(controller.getGridPlayer1.getField(row, col) == 0) {
                                                        <span class="blue">~</span>
                                                }
                                                else if(controller.getGridPlayer1.getField(row, col) == 1) {
                                                        <span class="green">x</span>
                                                } else if(controller.getGridPlayer1.getField(row, col) == 2) {
                                                        <span class="red">x</span>
                                                } else if(controller.getGridPlayer1.getField(row, col) == 3) {
                                                        <span class="lightblue">0</span>
                                                }
                                            }
                                        }
                                        </button>

                                    </span>
                                }
                                </div>
                                <div class="clear"></div>
                            }
                        </div>

                        <div class="player2 col-md-6">
                            <div class="playerName">
                            @{
                                controller.getPlayer2.toString
                            }
                            </div>
                            <div class="clear"></div>
                            @for(row <- 0 until 10) {
                                <div class="grid-container">
                                @for(col <- 0 until 10) {
                                    <span class="grid-item">
                                        <button name="submit" type="button" class="btn btn-outline-secondary buttonSize" id="2@row@col" onclick="handleClick(@row, @col)">

                                        @{
                                            if(controller.getPlayerState == PlayerState.PLAYER_TWO) {
                                                if(controller.getGridPlayer2.getValue(row, col) == 0) {
                                                        <span class="blue">~</span>
                                                }
                                                else if(controller.getGridPlayer2.getValue(row, col) == 1) {
                                                        <span class="green">x</span>
                                                } else if(controller.getGridPlayer2.getValue(row, col) == 2) {
                                                        <span class="red">x</span>
                                                } else if(controller.getGridPlayer2.getValue(row, col) == 3) {
                                                        <span class="lightblue">0</span>
                                                }
                                            } else if(controller.getPlayerState == PlayerState.PLAYER_ONE) {
                                                if(controller.getGridPlayer2.getField(row, col) == 0) {
                                                        <span class="blue">~</span>
                                                }
                                                else if(controller.getGridPlayer2.getField(row, col) == 1) {
                                                        <span class="green">x</span>
                                                } else if(controller.getGridPlayer2.getField(row, col) == 2) {
                                                        <span class="red">x</span>
                                                } else if(controller.getGridPlayer2.getField(row, col) == 3) {
                                                        <span class="lightblue">0</span>
                                                }

                                            }
                                        }
                                        </button>
                                    </span>
                                }
                                </div>
                                <div class="clear"></div>
                            }

                        </div>
                    </div>
                </div>
            </body>
    </div>
}
